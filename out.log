nohup: ignoring input
Namespace(conf_thres=0.001, dataDir='', iou_thres=0.6, local_rank=-1, logDir='runs/', modelDir='', prevModelDir='', sync_bn=False)
AUTO_RESUME: False
CUDNN:
  BENCHMARK: True
  DETERMINISTIC: False
  ENABLED: True
DATASET:
  COLOR_RGB: False
  DATAROOT: /mnt/mmlab2024nas/huycq/chuong/temp/YOLOP/data/woodscape_m/images
  DATASET: BddDataset
  DATA_FORMAT: png
  FLIP: True
  HSV_H: 0.015
  HSV_S: 0.7
  HSV_V: 0.4
  LABELROOT: /mnt/mmlab2024nas/huycq/chuong/temp/YOLOP/data/woodscape_m/det_annotations
  LANEREGROOT: /mnt/mmlab2024nas/huycq/chuong/temp/YOLOP/data/woodscape_m/images
  LANEROOT: /mnt/mmlab2024nas/huycq/chuong/temp/YOLOP/data/woodscape_m/ll_seg_annotations
  MASKROOT: /mnt/mmlab2024nas/huycq/chuong/temp/YOLOP/data/woodscape_m/da_seg_annotations
  ORG_IMG_SIZE: [966, 1280]
  PERSONROOT: /mnt/mmlab2024nas/huycq/chuong/temp/YOLOP/data/woodscape_m/person_seg_annotations
  ROT_FACTOR: 10
  SCALE_FACTOR: 0.25
  SELECT_DATA: False
  SHEAR: 0.0
  TEST_SET: val
  TRAIN_SET: train
  TRANSLATE: 0.1
  VEHICLEROOT: /mnt/mmlab2024nas/huycq/chuong/temp/YOLOP/data/woodscape_m/vehicle_seg_annotations
DEBUG: False
GPUS: (0,)
LOG_DIR: runs/
LOSS:
  BOX_GAIN: 0.05
  CLS_GAIN: 0.5
  CLS_POS_WEIGHT: 1.0
  DA_SEG_GAIN: 0.2
  FL_GAMMA: 2.0
  LL_IOU_GAIN: 0.2
  LL_SEG_GAIN: 0.2
  LOSS_NAME: 
  MULTI_HEAD_LAMBDA: None
  OBJ_GAIN: 1.0
  OBJ_POS_WEIGHT: 1.0
  PERSON_IOU_GAIN: 0.2
  PERSON_SEG_GAIN: 0.2
  SEG_POS_WEIGHT: 1.0
  VEHICLE_SEG_GAIN: 0.2
MODEL:
  EXTRA:
    
  HEADS_NAME: ['']
  IMAGE_SIZE: [960, 960]
  NAME: 
  PRETRAINED: 
  PRETRAINED_DET: 
  STRU_WITHSHARE: False
NEED_AUTOANCHOR: False
PIN_MEMORY: True
PRINT_FREQ: 20
TEST:
  BATCH_SIZE_PER_GPU: 8
  MODEL_FILE: 
  NMS_CONF_THRESHOLD: 0.001
  NMS_IOU_THRESHOLD: 0.6
  PLOTS: True
  SAVE_JSON: False
  SAVE_TXT: False
TRAIN:
  ANCHOR_THRESHOLD: 4.0
  BATCH_SIZE_PER_GPU: 16
  BEGIN_EPOCH: 0
  DET_ONLY: False
  DRIVABLE_ONLY: False
  ENC_DET_ONLY: False
  ENC_SEG_ONLY: False
  END_EPOCH: 80
  GAMMA1: 0.99
  GAMMA2: 0.0
  IOU_THRESHOLD: 0.2
  LANE_ONLY: False
  LR0: 0.01
  LRF: 0.1
  MOMENTUM: 0.937
  NESTEROV: True
  OPTIMIZER: sgd
  PLOT: False
  SEG_ONLY: False
  SHUFFLE: True
  VAL_FREQ: 1
  WARMUP_BIASE_LR: 0.1
  WARMUP_EPOCHS: 3.0
  WARMUP_MOMENTUM: 0.8
  WD: 0.0005
WORKERS: 8
cls_loss_weight: 6.0
cut_height: 0
img_h: 320
img_w: 800
iou_loss_weight: 2.0
max_lanes: 13
mixup_rate: 0.15
mosaic_rate: 0.0
num_classes: 14
num_points: 72
num_seg_class: 4
seg_loss_weight: 1.0
xyt_loss_weight: 0.5
Using torch 1.12.1 CUDA:0 (NVIDIA RTX A5000, 24256MB)


0it [00:00, ?it/s]
182it [00:00, 1811.45it/s]
381it [00:00, 1859.04it/s]
566it [00:00, 1856.04it/s]
733it [00:00, 1424.53it/s]
921it [00:00, 1534.37it/s]
1114it [00:00, 1632.58it/s]
1314it [00:00, 1726.91it/s]
1515it [00:00, 1802.22it/s]
1710it [00:00, 1841.79it/s]
1893it [00:01, 1827.60it/s]
2079it [00:01, 1836.32it/s]
2262it [00:01, 1671.49it/s]
2432it [00:01, 1563.23it/s]
2592it [00:01, 1565.55it/s]
2782it [00:01, 1651.34it/s]
2961it [00:01, 1688.80it/s]
3141it [00:01, 1720.24it/s]
3319it [00:01, 1736.66it/s]
3501it [00:02, 1757.86it/s]
3687it [00:02, 1784.77it/s]temp
3867it [00:02, 1753.17it/s]
4043it [00:02, 1677.81it/s]
4212it [00:02, 1643.21it/s]
4378it [00:02, 1634.74it/s]temp
4558it [00:02, 1680.59it/s]
4734it [00:02, 1702.45it/s]temp
4911it [00:02, 1721.25it/s]
5093it [00:02, 1748.69it/s]
5269it [00:03, 1728.64it/s]
5443it [00:03, 1723.64it/s]temp
5616it [00:03, 1712.62it/s]
5790it [00:03, 1718.81it/s]
5971it [00:03, 1743.82it/s]
6146it [00:03, 1734.05it/s]
6328it [00:03, 1756.86it/s]
6504it [00:03, 1728.38it/s]
6678it [00:03, 1725.90it/s]
6851it [00:04, 1552.16it/s]
7010it [00:04, 1426.25it/s]
7158it [00:04, 1367.23it/s]
7299it [00:04, 1277.74it/s]
7410it [00:04, 1637.27it/s]

0it [00:00, ?it/s]
149it [00:00, 1488.36it/s]
272it [00:00, 1396.93it/s]
397it [00:00, 1348.46it/s]
520it [00:00, 1309.46it/s]
646it [00:00, 1293.25it/s]
777it [00:00, 1297.56it/s]
824it [00:00, 1297.10it/s]=> creating runs/BddDataset/_2025-02-27-19-41
begin to bulid up model...
load model to device
begin to load data
train
building database...
database build finish
val
building database...
database build finish
load data finished
=> start training...

/opt/conda/lib/python3.7/site-packages/torch/functional.py:478: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484809535/work/aten/src/ATen/native/TensorShape.cpp:2894.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
Traceback (most recent call last):
  File "tools/train.py", line 370, in <module>
    main()
  File "tools/train.py", line 297, in main
    epoch, num_batch, num_warmup, writer_dict, logger, device, rank)
  File "/mnt/mmlab2024nas/huycq/chuong/temp/YOLOPX/lib/core/function.py", line 81, in train
    total_loss, head_losses = criterion(outputs, target, shapes,model,input)            
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/mmlab2024nas/huycq/chuong/temp/YOLOPX/lib/core/loss.py", line 48, in forward
    total_loss, head_losses = self._forward_impl(head_fields, head_targets, shapes, model, imgs)
  File "/mnt/mmlab2024nas/huycq/chuong/temp/YOLOPX/lib/core/loss.py", line 110, in _forward_impl
    reg_all_loss = CLR_Loss(predictions[5], targets[5], ll_seg_loss)
  File "/opt/conda/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/mmlab2024nas/huycq/chuong/temp/YOLOPX/lib/models/clr_loss.py", line 211, in forward
    cls_acc.append(sum(cls_acc_stage) / len(cls_acc_stage))
ZeroDivisionError: division by zero
